<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="RedirectionTool">

<metal:block fill-slot="head_slot">
   <tal:block define="dummy python:request.set('disable_border',1)" />
</metal:block>
      
<body>

    <div metal:fill-slot="prefs_configlet_main">	

<tal:logic condition="request/save | nothing">
    <tal:logic define="dummy python: container.portal_redirection.setRedirectionAllowedForTypes(request.get('redirection_types'))" />
</tal:logic>
<tal:logic condition="request/clear_redirection_types | nothing">
    <tal:logic define="dummy python: container.portal_redirection.setRedirectionAllowedForTypes()" />
</tal:logic>

        <h1 i18n:translate="heading_redirection_config">Redirection Tool 
configuration</h1>

        <div class="description" i18n:translate="description_configure"> 
        Here you can configure settings for Redirection Tool.
        </div>
        
        <form class="group"
              name="prefs_redirection_tool_form"
              action="." 
              method="post" 
              enctype="multipart/form-data"
              tal:attributes="action template/getId" >
            <span class="legend" i18n:translate="legend_prefs_redirection_tool">Redirection</span>    
          
            <div class="row">
            
                <div class="label">
                    <span i18n:translate="label_item_type">Item type</span>
                    <div id="item_type_search_help"
                         i18n:translate="help_redirection_item_type"
                         class="help"
                         style="visibility:hidden">
                    Allow specified types to have redirection.
                    </div>
                </div>
    
                <div class="field"
                     tal:define="allowtypes python:container.portal_redirection.getRedirectionAllowedForTypes()" 
                     i18n:domain="plone">
                    <span tal:repeat="type python:container.portal_types.listContentTypes()">
                        <metal:block tal:define="tabindex tabindex/next">
                        <input type="checkbox"
                               name="redirection_types:list"
                               value="#"
                               class="noborder"
                               tabindex=""
                               onfocus="formtooltip('item_type_search_help',1)"
                               onblur="formtooltip('item_type_search_help',0)"
                               tal:attributes="value type;
                                               tabindex tabindex;
                                               checked python: type in allowtypes;
                                               id string:redirection_types_${tabindex}"/>
                        <label for=""
                               i18n:translate=""
                               tal:attributes="for string:portal_type_${tabindex}"
                               tal:content="python:here.portal_types.getTypeInfo(type).Title()"
                               />
                        <br />
                        </metal:block>
                    </span>
                </div>
            </div>

            <div class="row">
                <div class="label">&nbsp;</div>
                <div class="field">
                    <input class="context"
                           tabindex=""
                           type="submit"
                           name="save"
                           value="Save"
                           i18n:attributes="value"
                           tal:attributes="tabindex tabindex/next;"
                           />
                    <input class="context"
                           tabindex=""
                           type="submit"
                           name="clear_redirection_types"
                           value="Allow all types"
                           i18n:attributes="value"
                           tal:attributes="tabindex tabindex/next;"
                           />
                </div>
            </div>

        </form>

    </div>

</body>
</html>
